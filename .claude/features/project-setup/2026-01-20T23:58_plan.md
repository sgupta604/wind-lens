# Implementation Plan: project-setup

## Metadata
- **Feature:** project-setup
- **Created:** 2026-01-20T23:58
- **Status:** plan-complete
- **Based On:** 2026-01-20T23:56_research.md

---

## Overview

This plan covers the initial Flutter project setup for Wind Lens - an AR wind visualization app. This is Feature 0, the foundation upon which all other features will be built.

### Goals
- Create a working Flutter project structure
- Configure all required dependencies
- Set up platform-specific permissions for camera, location, and sensors
- Verify the project builds successfully

### Non-Goals
- Implementing any actual features (camera, sensors, etc.)
- Writing application code beyond the default Flutter template
- Setting up CI/CD pipelines

---

## Architecture Overview

```
/workspace/wind_lens/                    # Project root
├── pubspec.yaml                         # Dependencies configuration
├── lib/
│   └── main.dart                        # Default app entry (template)
├── ios/
│   ├── Runner/
│   │   └── Info.plist                   # iOS permissions
│   └── Podfile                          # iOS CocoaPods config
├── android/
│   ├── app/
│   │   └── src/main/
│   │       └── AndroidManifest.xml      # Android permissions
│   └── build.gradle                     # Android SDK versions
└── test/
    └── widget_test.dart                 # Default widget test
```

### Dependency Flow

```
flutter create wind_lens
         │
         ▼
┌─────────────────────────┐
│    pubspec.yaml         │
│  ├── camera: ^0.11.3    │
│  ├── sensors_plus: ^7.0.0│
│  ├── vector_math: ^2.2.0│
│  └── http: ^1.6.0       │
└─────────────────────────┘
         │
         ▼
┌─────────────────────────┐     ┌─────────────────────────┐
│   iOS Configuration     │     │  Android Configuration  │
│  ├── Info.plist         │     │  ├── AndroidManifest.xml│
│  ├── Podfile (iOS 14.0) │     │  └── build.gradle       │
│  └── pod install        │     │      (minSdk 24)        │
└─────────────────────────┘     └─────────────────────────┘
         │                               │
         └───────────┬───────────────────┘
                     │
                     ▼
            flutter pub get
                     │
                     ▼
            flutter build
           (verify success)
```

---

## Tech Stack Summary

| Component | Choice | Version/Constraint |
|-----------|--------|-------------------|
| Framework | Flutter | 3.x (stable) |
| Language | Dart | Latest stable |
| iOS Minimum | 14.0 | ARKit compatibility |
| Android Minimum | API 24 | ARCore compatibility |
| camera | Camera access | ^0.11.3 |
| sensors_plus | Compass/accelerometer | ^7.0.0 |
| vector_math | Vector calculations | ^2.2.0 |
| http | API calls | ^1.6.0 |

---

## File Structure

### New Files (Created by `flutter create`)

| File | Purpose |
|------|---------|
| `/workspace/wind_lens/pubspec.yaml` | Project configuration and dependencies |
| `/workspace/wind_lens/lib/main.dart` | App entry point (template) |
| `/workspace/wind_lens/test/widget_test.dart` | Default widget test |
| `/workspace/wind_lens/ios/Runner/Info.plist` | iOS app configuration |
| `/workspace/wind_lens/ios/Podfile` | iOS CocoaPods dependencies |
| `/workspace/wind_lens/android/app/src/main/AndroidManifest.xml` | Android manifest |
| `/workspace/wind_lens/android/app/build.gradle` | Android build config |

### Files to Modify

| File | Changes |
|------|---------|
| `pubspec.yaml` | Add camera, sensors_plus, vector_math, http dependencies |
| `ios/Runner/Info.plist` | Add NSCameraUsageDescription, NSLocationWhenInUseUsageDescription, NSMotionUsageDescription, UIRequiredDeviceCapabilities |
| `ios/Podfile` | Set platform to iOS 14.0 |
| `android/app/src/main/AndroidManifest.xml` | Add CAMERA, ACCESS_FINE_LOCATION permissions; add hardware features |
| `android/app/build.gradle` | Set minSdkVersion to 24 |

---

## Configuration Details

### pubspec.yaml Dependencies

```yaml
dependencies:
  flutter:
    sdk: flutter
  camera: ^0.11.3
  sensors_plus: ^7.0.0
  vector_math: ^2.2.0
  http: ^1.6.0

dev_dependencies:
  flutter_test:
    sdk: flutter
  flutter_lints: ^5.0.0
```

### iOS Info.plist Permissions

```xml
<key>NSCameraUsageDescription</key>
<string>Wind Lens needs camera access to show AR wind overlay</string>

<key>NSLocationWhenInUseUsageDescription</key>
<string>Wind Lens uses location for accurate wind data</string>

<key>NSMotionUsageDescription</key>
<string>Wind Lens needs motion sensors for compass heading</string>

<key>UIRequiredDeviceCapabilities</key>
<array>
  <string>accelerometer</string>
  <string>gyroscope</string>
</array>
```

### iOS Podfile

```ruby
platform :ios, '14.0'
```

### Android AndroidManifest.xml

```xml
<uses-permission android:name="android.permission.CAMERA" />
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

<uses-feature android:name="android.hardware.camera" android:required="true" />
<uses-feature android:name="android.hardware.sensor.compass" android:required="true" />
```

### Android build.gradle

```gradle
android {
    defaultConfig {
        minSdkVersion 24
    }
}
```

---

## Testing Strategy

### Verification Tests (Manual)

Since this is a setup feature, testing is primarily verification-based:

| Test | Command | Expected Result |
|------|---------|-----------------|
| Dependencies install | `flutter pub get` | Exit code 0, no errors |
| Android build | `flutter build apk --debug` | BUILD SUCCESSFUL |
| iOS build | `flutter build ios --simulator --no-codesign` | Build succeeded |
| Default test runs | `flutter test` | All tests passed |

### Unit Tests

The default Flutter project includes a widget test. We'll verify it passes:
- `test/widget_test.dart` - Default counter app test (from template)

### Acceptance Criteria Verification

- [ ] Project created at `/workspace/wind_lens`
- [ ] All 4 dependencies in pubspec.yaml
- [ ] iOS permissions configured (3 usage descriptions + capabilities)
- [ ] Android permissions configured (2 permissions + 2 features)
- [ ] iOS minimum version set to 14.0
- [ ] Android minSdkVersion set to 24
- [ ] `flutter pub get` succeeds
- [ ] `flutter test` passes
- [ ] Build succeeds (at least one platform)

---

## Implementation Notes

### Decisions

1. **Use CLAUDE.md versions over spec versions** - Research document identified CLAUDE.md has more recent package versions
2. **Keep default main.dart** - No application code in this feature; just setup
3. **Build verification order** - Run `flutter pub get` first, then verify with build commands

### Patterns

- Standard Flutter project structure
- Platform-specific configuration in native folders

### Trade-offs

- **Simulator build only for verification** - Real device testing requires physical hardware
- **No actual feature implementation** - This keeps the feature focused and testable

---

## Risks and Mitigations

| Risk | Likelihood | Impact | Mitigation |
|------|------------|--------|------------|
| Flutter version incompatibility | Low | High | Use stable channel, verify flutter version |
| Pod install issues | Medium | Medium | Use documented rebuild command if needed |
| Dependency conflicts | Low | Medium | Test `flutter pub get` early in process |
| Android SDK not installed | Low | High | Verify Android toolchain with `flutter doctor` |

---

## Handoff to Implement Agent

When this plan is complete, the Implement Agent should:

1. Follow tasks.md in strict order
2. Verify each step before proceeding to next
3. Run verification commands after each configuration change
4. Document any issues in implementation.md

The project will be ready for Feature 1 (camera-feed) when:
- All tasks marked complete
- Build succeeds on at least one platform
- Default tests pass
